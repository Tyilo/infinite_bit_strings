See http://math.andrej.com/2007/09/28/seemingly-impossible-functional-programs/
